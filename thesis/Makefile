vpath %.dot figs
vpath %.eps eps

DOTFLAGS := -Gcharset=latin1

eps = eltecimer.eps
figs = arch.dot grw_5.dot grw_14.dot grw_15.dot \
	grw_new_28.dot graf_ekv_izo.dot headlistlist.dot \
	rwr_redir.dot hamm_share.dot hamm_recurse.dot \
	sharing1.dot sharing2.dot

all: aux/diplomamunka.dvi
	latex -file-line-error -halt-on-error -output-directory=aux diplomamunka.tex
	mkdir -p out
	dvipdfm -o out/diplomamunka.pdf aux/diplomamunka.dvi

aux/diplomamunka.dvi: eps aux *.tex *.sty
	latex -file-line-error -halt-on-error -output-directory=aux diplomamunka.tex

aux:
	mkdir -p aux

%.eps : %.dot
	dot $(DOTFLAGS) -Teps $< -o eps/$@

eps: $(eps) $(patsubst %.dot,%.eps, $(figs)) $(figs)

clean:
	rm -rf aux/

distclean: clean
	rm -rf out/

.PHONY: all clean distclean
